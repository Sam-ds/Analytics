from pyspark.sql import SparkSession
from pyspark.sql.types import StructField
from pyspark.sql.types import StructType
from pyspark.sql.types import StringType 
from pyspark.sql.types import IntegerType 

spark = SparkSession.Builder().appName("Temperature Change across world").getOrCreate()
sc = spark.sparkContext()
data = sc.textFile("C:/sparksqlucs/HVAC.csv")
header = data.first()
dataWithoutHeader = data.filter(lambda row : row != header)
fields=[StructField("Date", StringType(), True),\
StructField("Time", StringType(), True),\
StructField("TargetTemp", IntegerType(), True),\
StructField("ActualTemp", IntegerType(), True),\
StructField("System", IntegerType(), True),\
StructField("SystemAge", IntegerType(), True),\
StructField("BuildingId", IntegerType(), True)]
hvac = dataWithoutHeader.map(lambda x : x.split(",")).map(lambda p: (p[0], p[1].strip(),int(p[2]),int(p[3]),int(p[4]),int(p[5]),int(p[6])))
schema = StructType(fields)
hvacdf = spark.createDataFrame(hvac,schema)
hvacdf.show()




